<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `NetworkFilesystem` trait in crate `netfuse`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, NetworkFilesystem">

    <title>netfuse::NetworkFilesystem - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>netfuse</a></p><script>window.sidebarCurrent = {name: 'NetworkFilesystem', ty: 'trait', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content trait">
<h1 class='fqn'><span class='in-band'>Trait <a href='index.html'>netfuse</a>::<wbr><a class='trait' href=''>NetworkFilesystem</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-198' class='srclink' href='../src/netfuse/src/nfs.rs.html#45-148' title='goto source code'>[src]</a></span></h1>
<pre class='rust trait'>pub trait NetworkFilesystem {
    fn <a href='#method.init' class='fnname'>init</a>(&amp;mut self) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.lookup' class='fnname'>lookup</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='struct' href='../netfuse/struct.Metadata.html' title='netfuse::Metadata'>Metadata</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.read' class='fnname'>read</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>, _buffer: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.write' class='fnname'>write</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>, _data: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.readdir' class='fnname'>readdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html' title='alloc::boxed::Box'>Box</a>&lt;<a class='trait' href='https://doc.rust-lang.org/nightly/core/iter/iterator/trait.Iterator.html' title='core::iter::iterator::Iterator'>Iterator</a>&lt;Item=<a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='struct' href='../netfuse/struct.DirEntry.html' title='netfuse::DirEntry'>DirEntry</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;&gt;&gt; { ... }
    fn <a href='#method.mkdir' class='fnname'>mkdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.rmdir' class='fnname'>rmdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
    fn <a href='#method.unlink' class='fnname'>unlink</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt; { ... }
}</pre><div class='docblock'><p>Trait to implement to provide a backend store for a <code>NetFuse</code> filesystem</p>

<p>The methods in this trait are abstractions over the low level method provided
by the FUSE library&#39;s <code>Filesystem</code> trait. The <code>NetFuse</code> implementation of <code>FileSystem</code>
will manage many of the low-level details like inode numbers, offsets, sizes,
and lazy persistence.</p>

<p>In doing so, implementing a backend store for <code>NetFuse</code> (ie. implementing <code>NetworkFilesystem</code>)
is mostly a matter of making network network calls that map to very common filesystem operations.</p>

<p>The default implementation is just enough to mount a filesystem that supports no read or write operations</p>
</div>
            <h2 id='provided-methods'>Provided Methods</h2>
            <div class='methods'>
        <h3 id='method.init' class='method stab '><code>fn <a href='#method.init' class='fnname'>init</a>(&amp;mut self) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Any arbitrary code to run when mounting</p>

<p>Returning an error will result in an error during mounting (TODO: verify)</p>
</div><h3 id='method.lookup' class='method stab '><code>fn <a href='#method.lookup' class='fnname'>lookup</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='struct' href='../netfuse/struct.Metadata.html' title='netfuse::Metadata'>Metadata</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Returns the metadata for a file or directory associated with a given</p>

<p>This typically corresponds to operations like <code>stat</code>.
This method is called when the <code>NetFuse</code> inode store did not find
cached inode data for this <code>path</code>. Any returned <code>Metadata</code> will be heavily cached.</p>

<p>See <code>man 2 stat</code> for more information including appropriate errors to return.</p>
</div><h3 id='method.read' class='method stab '><code>fn <a href='#method.read' class='fnname'>read</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>, _buffer: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Reads the contents of a file associated with a given path</p>

<p>This is called on the first filesystem attempt to <code>read</code> a file,
  since reading happens in chunks, the underlying <code>NetFuse</code> implemenation
  will cache the result returned and read it in from the cache in chunks
  without additional calls to this method.</p>

<p>The cached data will be freed when there are no remaining open handles on this file.</p>

<p>See <code>man 2 read</code> for more information including appropriate errors to return.</p>
</div><h3 id='method.write' class='method stab '><code>fn <a href='#method.write' class='fnname'>write</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>, _data: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Write data back to the network backend</p>

<p>This is not actually called when the filesystem calls <code>write</code>.
  Instead this is called when <code>NetFuse</code> handles an <code>fsync</code>
  or during <code>release</code> for a file handle that modified the cached copy.</p>

<p>Note: the <code>release</code> implementation might change in the future in favor of
  a configurable defferred commit</p>

<p>This method will only be called if:
- a previous <code>lookup</code> has confirmed a file exists at this path
- the volume was mounted with the <code>rw</code> option</p>

<p>See <code>man 2 fsync</code> for more information including appropriate errors to return.</p>
</div><h3 id='method.readdir' class='method stab '><code>fn <a href='#method.readdir' class='fnname'>readdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html' title='alloc::boxed::Box'>Box</a>&lt;<a class='trait' href='https://doc.rust-lang.org/nightly/core/iter/iterator/trait.Iterator.html' title='core::iter::iterator::Iterator'>Iterator</a>&lt;Item=<a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='struct' href='../netfuse/struct.DirEntry.html' title='netfuse::DirEntry'>DirEntry</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;&gt;&gt;</code></h3><div class='docblock'><p>List contents of a directory</p>

<p>This method should return an iterator over the contents of the directory
  specified by <code>path</code>. By returning an iterator, <code>NetFuse</code> can begin listing
  contents sooner in the cases where listing may require multiple paged network requests.</p>

<p>These value will be cached to prevent additional listing. The current cache implementation
  will likely change as it is not friendly to cases where the data changes outside the filesystem.
  Until then, unmount and re-mount the volume to clear the directory listing cache.</p>

<p>See <code>man 2 readdir</code> for more information including appropriate errors to return.</p>

<p>Note: this method will likely return <code>impl Iterator&lt;Item=Result&lt;DirEntry, LibcError&gt;&gt;</code> once <code>impl Trait</code> lands in nightly</p>
</div><h3 id='method.mkdir' class='method stab '><code>fn <a href='#method.mkdir' class='fnname'>mkdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Creates an empty directory for the given path</p>

<p>This method is only called if:
- a previous <code>lookup</code> has confirmed the parent path was a directory
- the volume is mounted with the <code>rw</code> option</p>

<p>See <code>man 2 mkdir</code> for more information including appropriate errors to return.</p>
</div><h3 id='method.rmdir' class='method stab '><code>fn <a href='#method.rmdir' class='fnname'>rmdir</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Removes the directory that corresponds to a given path</p>

<p>This method is only called if:
- a previous <code>lookup</code> has confirmed a directory exists at this path
- the volume is mounted with the <code>rw</code> option</p>

<p>See <code>man 2 rmdir</code> for more information including appropriate errors to return.
  Namely: you&#39;ll generally want to return ENOTEMPTY if the directory is not empty</p>
</div><h3 id='method.unlink' class='method stab '><code>fn <a href='#method.unlink' class='fnname'>unlink</a>(&amp;mut self, _path: &amp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/path/struct.Path.html' title='std::path::Path'>Path</a>) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;<a class='type' href='../netfuse/type.LibcError.html' title='netfuse::LibcError'>LibcError</a>&gt;</code></h3><div class='docblock'><p>Removes the file that corresponds to a given path</p>

<p>This method is only called if:
- a previous <code>lookup</code> has confirmed a file exists at this path
- the volume is mounted with the <code>rw</code> option</p>

<p>See <code>man 2 unlink</code> for more information including appropriate errors to return.</p>
</div></div>
        <h2 id='implementors'>Implementors</h2>
        <ul class='item-list' id='implementors-list'>
    </ul><script type="text/javascript" async
                         src="../implementors/netfuse/trait.NetworkFilesystem.js">
                 </script></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "netfuse";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>